# 1 简介

商品期货趋势类策略，日线级别低频策略。

策略测试标的和品种：商品期货合约，具体测试内容如下：

- 单品种测试：要求选择螺纹钢 rb，可使用连续合约。暂时可不用考虑标的的实际可交易性（如连续合约）、合约换月等实际交易细节。回测起始时间自 2010/1/1 至今；
- 全品种测试：要求 36 个活跃品种进行全品种测试。

# 2 策略

根据布林带实现做多/做空：

- 当股价由下向上穿过上轨的时候，做多；然后由上向下穿过中轨的时候，平仓。

- 当股价由上向下穿过下轨的时候，做空；然后由下向上穿过中轨的时候，平仓。

# 3 仓位管理方法（未实现）

要求清晰描述：交易资金、交易信号、每日仓位结果之间的转化关系，收益率计算方式。并列举一个交易示例，完整描述一个交易周期内的交易行为。

- 标的：单标的/多标的

- 调仓周期：按日调仓

- 信号描述：

  在收盘之后用当日的Close计算展期收益率R：

  - 如果R > 0，做多；
  - 如果R < 0，做空；
  - 如果R = 0，清仓。

- 仓位方法描述：

  1. 单品种：

     账户初始资产 initCap= 1000W

     每日交易资金 ALLOCATION = 1000W

     如果当日做多，当日期望仓位 P = alloc / 单张合约价值

     如果当日做空，当日期望仓位 P = - alloc / 单张合约价值

     如果当日清仓，当日期望仓位 P = 0

  2. 多品种

     每日交易品种如何确定；

     每日交易各品种可交易资金分配算法。

- 收益计算方法描述：

  1. 相对收益率：

     在策略还处于研究阶段时，可以简单按照主连合约复权后的价格来计算净值的变化，不需要考虑真实价格，换月和收益计算切片方式等处理，方便策略研究。

  2. 绝对收益：

     策略将进入转译阶段后，需要使用绝对收益率的计算方式，即用资金、仓位、合约真实价格计算每日收益（资产绝对变化），算法如下：

     当日收益 = 账户第N日资产  -  账户第（N-1）日资产 

     当日收益率 = 当日收益 / 初始资产 

     总收益 = 账户第N日资产 - 初始资产

     总收益率 = 总收益 / 初始资产 - 1

# 4 策略表现

| 指标                         |
| ---------------------------- |
| ✅ 买入/卖出信号模拟图        |
| ❌ 仓位模拟图                 |
| ✅ PNL（Profit and Loss）曲线 |
| ✅ 夏普比率                   |
| ✅ 卡玛比率                   |
| ✅ 年化收益率                 |
| ✅ 最大回撤率                 |
| ✅ 最大回撤时间               |
| ✅ 最大回撤修复时间           |
| ✅ 波动率                     |
| ✅ 参数敏感性分析热力图       |

# 5 不足

1. 一直是全仓交易，没有仓位控制策略；
2. 根据布林带策略还可以继续细分，比如开口时根据中轨方向判断趋势。

# 6 几个有用的包

1. Parallel：可以并行回测多个标的；
2. pyfolio：画出仓位图、回撤图etc.；
3. empyrical：计算Sharpe、Calmar等指标。

# 7 参考资料

[Python实现布林带策略](https://blog.csdn.net/mfsdmlove/article/details/126382673)

[Python计算最大回撤-1](https://blog.csdn.net/Jimmy_dovici/article/details/121204139)

[Python计算最大回撤-2](https://blog.csdn.net/m0_37967652/article/details/122600932)

[Python计算最大回撤-3](https://www.imooc.com/article/275757/)



















